# Copy this file to .env and fill in your secrets
OPENROUTER_API_KEY=sk-or-REPLACE_ME
TAVILY_API_KEY=tvly-REPLACE_ME
HF_TOKEN=hf_REPLACE_ME

# LanceDB
LANCEDB_PATH=./lancedb_data
LANCEDB_TABLE=user_guide

# Models
EMBEDDING_MODEL_ID=google/embeddinggemma-300m
RERANKER_MODEL_ID=BAAI/bge-reranker-v2-m3
LLM_MODEL_ID=qwen/qwen3-30b-a3b-instruct-2507

# Memory
MEMORY_ENABLED=true
MEMORY_MODEL_ID=qwen/qwen3-30b-a3b-instruct-2507
MEMORY_TEMPERATURE=0.2
MEMORY_MAX_TOKENS=2000
MEMORY_SEARCH_LIMIT=5
MEMORY_DEFAULT_USER_ID=alma
MEMORY_CATEGORY=general
# MEMORY_SITE_URL=http://localhost:8000
# MEMORY_APP_NAME=UserGuide-RAG
# Mem0 backend
# При использовании OpenRouter с провайдером "openai" Mem0 будет читать переменные OPENAI_*
# Базовый URL будет взят из OPENROUTER_ENDPOINT автоматически, но для совместимости можно указать явно
# OPENAI_BASE_URL=https://openrouter.ai/api/v1
MEMORY_EMBEDDER_PROVIDER=huggingface
MEMORY_EMBEDDER_MODEL_ID=sentence-transformers/all-MiniLM-L6-v2
# Должно совпадать с размерностью выбранной модели эмбеддера (например, 384 для MiniLM)
MEMORY_EMBEDDING_DIMS=384
MEMORY_VECTOR_STORE_PROVIDER=faiss
# Директория для файла(ов) индекса FAISS, используемого Mem0
MEMORY_FAISS_PATH=./mem0_data/faiss
# Параметры векторной метрики для FAISS: euclidean | inner_product | cosine
MEMORY_VECTOR_DISTANCE=cosine
# Включить L2-нормализацию (рекомендуется при cosine)
MEMORY_VECTOR_NORMALIZE_L2=true

# Runtime
DEVICE=cuda
BATCH_SIZE_EMBED=64
BATCH_SIZE_RERANK=16

# Ingestion
CHUNK_SIZE_TOKENS=1000
CHUNK_OVERLAP_TOKENS=200
PREFER_DOCLING_API=true
ENABLE_CLI_FALLBACK=true
ENABLE_OCR=true
PRESERVE_CASE=true
STRIP_HEADERS_FOOTERS=true
MERGE_HYPHENATION=true
TABLE_MODE=md
MAX_PARALLEL_PAGES=4
ALLOWED_EXTS=.pdf,.docx,.pptx,.xlsx,.html,.htm,.txt

# Web fallback (optional)
ENABLE_WEB_FALLBACK=true
MANUAL_MIN_RERANK_SCORE=0.35
MANUAL_MIN_CONTEXT_TOKENS=120
WEB_SEARCH_MAX_RESULTS=5
WEB_FETCH_TOP_N=3
WEB_CONTEXT_MAX_TOKENS=3200

## Tavily web search (replaces DuckDuckGo)
# TAVILY_API_KEY is required for web fallback to work

# HTTP fetching for web pages
WEB_HTTP_TIMEOUT=10.0
WEB_HTTP_VERIFY_TLS=true
WEB_USER_AGENT=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0 Safari/537.36
WEB_FETCH_MAX_CHARS=4000

# Web search filtering
WEB_SEARCH_FILTER_ENABLED=true
WEB_SEARCH_STOPWORDS_RU=что,такое,кто,где,зачем,как,почему,это,есть,и,или,в,на,по,за,из,для,про,от,до,над,под,с,со,об,обо,у,же,ли
WEB_SEARCH_MIN_TOKEN_LEN=3
WEB_SEARCH_REQUIRED_TOKEN_MATCHES=1
